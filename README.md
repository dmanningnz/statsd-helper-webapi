# statsd-helper-webapi

Filter attributes to allow easy metrics gathering based on Response Codes.

See https://github.com/paybyphone/statsd-helper configuring the statsd-helper itself.

Along with the prefix generated by the statsd-helper, the metric will append the action name and status code to the metric.

For example:
```
com.example.servername.api.validate.404
```

You can also return the latency of the request in the response headers:

```
X-ExecutionTime : 123ms
```

This is configurable by an appsetting, it is off by default.

```xml
<add key="StatsD.WebApi.Response.LatencyHeader.Enabled" value="true" />
```
Usage:

Add the filters to your WebApiConfiguration.

```csharp
    public static class WebApiConfig
    {
        public static void Register(HttpConfiguration config)
        {
            ...
            config.ConfigureInstrumentFilters();
            ...
        }

        private static void ConfigureInstrumentFilters(this HttpConfiguration config)
        {
            config.Filters.Add(new InstrumentStatusCodeFilterAttribute());
            config.Filters.Add(new InstrumentStatusCodeExceptionFilterAttribute());
        }
    }
```
